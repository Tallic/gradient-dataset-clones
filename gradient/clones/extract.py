import pathlib

import pandas as pd

rounds = {
    3264486: "R0-A",
    5304486: "R1-A",
    8294486: "R1-B",
    3274486: "R1-C",
    5314486: "R2-A",
    8304486: "R3-A",
    6314486: "R4-A"
}

tasks = {
    (5736519012712448, 0): "A-0",
    (5736519012712448, 1): "A-1",
    (5633382285312000, 0): "B-0",
    (5633382285312000, 1): "B-1",
    (5654742835396608, 0): "C-0",
    (5654742835396608, 1): "C-1",
    (5654742835396608, 2): "C-2",
    (5719854539603968, 0): "D-0",
    (5719854539603968, 1): "D-1",
    (5760761888505856, 0): "A-0",
    (5760761888505856, 1): "A-1",
    (5697460110360576, 0): "B-0",
    (5697460110360576, 1): "B-1",
    (5719039502450688, 0): "C-0",
    (5719039502450688, 1): "C-1",
    (5630967708385280, 0): "A-0",
    (5630967708385280, 1): "A-1",
    (5654117850546176, 0): "B-0",
    (5654117850546176, 1): "B-1",
    (5681755159789568, 0): "C-0",
    (5681755159789568, 1): "C-1",
    (5768968631484416, 0): "A-0",
    (5768968631484416, 1): "A-1",
    (5706636844859392, 0): "B-0",
    (5706636844859392, 1): "B-1",
    (5633143511973888, 0): "C-0",
    (5633143511973888, 1): "C-1",
    (5700919488413696, 0): "A-0",
    (5700919488413696, 1): "A-1",
    (5687148430753792, 0): "B-0",
    (5687148430753792, 1): "B-1",
    (5715646612504576, 0): "C-0",
    (5715646612504576, 1): "C-1",
    (5756983256809472, 0): "D-0",
    (5756983256809472, 1): "D-1",
    (5672542102618112, 0): "A-0",
    (5672542102618112, 1): "A-1",
    (6450220019744768, 0): "B-0",
    (6450220019744768, 1): "B-1",
    (5965456674390016, 0): "C-0",
    (5965456674390016, 1): "C-1",
    (5683362198978560, 0): "D-0",
    (5683362198978560, 1): "D-1",
    (5657124243767296, 0): "A-0",
    (5657124243767296, 1): "A-1",
    (5733677740851200, 0): "B-0",
    (5733677740851200, 1): "B-1",
    (5694482943049728, 0): "C-0",
    (5762803474366464, 0): "D-0",
    (5762803474366464, 1): "D-1",
    (5633035869356032, 0): "E-0",
    (5633035869356032, 1): "E-1",
    (5694323492388864, 0): "F-0",
    (5694323492388864, 1): "F-1",
}

df_raw = pd.read_csv("gcj2017.csv")
df = (
    df_raw[df_raw["file"].str.contains(".java")]
        .rename(columns={"Unnamed: 0": "index"})
        .drop(columns="index")
        .reset_index(drop=True)
        .iloc[:1]
)

dir_base = pathlib.Path("../")
for it in df.itertuples():
    classname_new = f"S{it.Index}"
    classname_old = it.file.split(".")[0]
    content = (it.flines.replace(f"class {classname_old}", f"class {classname_new}")
               .replace(f"{classname_old}.", f"{classname_new}."))

    dir_solution = pathlib.Path(dir_base, f"{rounds[it.round]}-{tasks[(it.task, it.solution)]}", classname_new)
    dir_solution.mkdir(parents=True, exist_ok=True)
    filename = pathlib.Path(dir_solution, f"{classname_new}.java")
    with filename.open("w") as f:
        f.write(content)
